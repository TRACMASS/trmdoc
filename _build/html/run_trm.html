<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Set-up and run the code &mdash; TRACMASS 4 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-2.3.2/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-2.3.2/css/bootstrap-responsive.min.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-2.3.2/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="TRACMASS 4 documentation" href="index.html" />
    <link rel="next" title="References" href="references.html" />
    <link rel="prev" title="Code Structure" href="code.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <a class="brand" href="index.html">TRACMASS</a>
        <span class="navbar-text pull-left"><b>4</b></span>

        <div class="nav-collapse">
          <ul class="nav">
            <li class="divider-vertical"></li>
            
              <li class="dropdown globaltoc-container">
  <a href="index.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="theory.html">Trajectory Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="turbulence.html">Sub-grid turbulence</a></li>
<li class="toctree-l1"><a class="reference internal" href="sedimentation.html">Sedimentation model</a></li>
<li class="toctree-l1"><a class="reference internal" href="diagnostics.html">Integrated Diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="code.html">Code Structure</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Set-up and run the code</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>
</ul>
</li>
              <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Set-up and run the code</a><ul>
<li><a class="reference internal" href="#how-to-run-tracmass">How to run TRACMASS</a></li>
<li><a class="reference internal" href="#how-to-read-the-output-files">How to read the output files</a><ul>
<li><a class="reference internal" href="#the-trajectories">The trajectories</a></li>
<li><a class="reference internal" href="#the-integrated-quantities">The integrated quantities</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-a-new-gcm-grid">Implementing a new GCM grid</a></li>
</ul>
</li>
</ul>
</ul>
</li>
            
            
              
  <li><a href="code.html"
         title="previous chapter">&laquo; Code Structure</a></li>
  <li><a href="references.html"
         title="next chapter">References &raquo;</a></li>
            
            
              <li>
  <a href="_sources/run_trm.txt"
     rel="nofollow">Source</a></li>
            
          </ul>

          
            
<form class="navbar-search pull-right" action="search.html" method="get">
  <input type="text" name="q" class="search-query" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
      </div>
    </div>
  </div>

<div class="container">
  
  <div class="section" id="set-up-and-run-the-code">
<h1>Set-up and run the code<a class="headerlink" href="#set-up-and-run-the-code" title="Permalink to this headline">¶</a></h1>
<p>Download tracmass.zip from <a class="reference external" href="http://doos.misu.su.se/tracmass/">http://doos.misu.su.se/tracmass/</a> and put
where you want it.</p>
<div class="section" id="how-to-run-tracmass">
<h2>How to run TRACMASS<a class="headerlink" href="#how-to-run-tracmass" title="Permalink to this headline">¶</a></h2>
<p>Make necessary changes in the Makefile by setting the appropriate
preprocessing options described in previous chapter.
Set the apropriate parameters in &lt;project&gt;_grid.in and
&lt;project&gt;_run.in. Compile by</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">cd</span> ../tracmass/tracsvn
make clean
make
<span class="o">(</span>alt<span class="o">)</span>
make -f Makefile.something
</pre></div>
</div>
<p>Run TRACMASS by executing</p>
<div class="highlight-bash"><div class="highlight"><pre>./runtracmass
</pre></div>
</div>
</div>
<div class="section" id="how-to-read-the-output-files">
<h2>How to read the output files<a class="headerlink" href="#how-to-read-the-output-files" title="Permalink to this headline">¶</a></h2>
<p>The output data from the TRACMASS runs are stored in the directory
&lt;outDataDir&gt;, which is set in &lt;project&gt;_run.in. There are basically two
types od output data: trejctories and integrated quantitites such as
stream functions.</p>
<div class="section" id="the-trajectories">
<h3>The trajectories<a class="headerlink" href="#the-trajectories" title="Permalink to this headline">¶</a></h3>
<p>The trajectories are stored in &lt;outDataDir&gt;/&lt;outDataFile&gt;_run.asc,
which has to be specified in &lt;project&gt;_run.in
The trajectories are stored in colums of
<strong>ntrac,niter,x1,y1,z1,tt,t0,subvol,temp,salt,dens</strong>
where</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">ntrac:</th><td class="field-body">Trajectory number</td>
</tr>
<tr class="field-even field"><th class="field-name">niter:</th><td class="field-body">TRACMASS code iteration (only important for TRACMASS modellers)</td>
</tr>
<tr class="field-odd field"><th class="field-name">x1:</th><td class="field-body">Zoonal position of the trajectory particle</td>
</tr>
<tr class="field-even field"><th class="field-name">y1:</th><td class="field-body">Meridional position of the trajectory particle</td>
</tr>
<tr class="field-odd field"><th class="field-name">z1:</th><td class="field-body">Vertical position of the trajectory particle</td>
</tr>
<tr class="field-even field"><th class="field-name">tt:</th><td class="field-body">Time of the trajectory particle (in days)</td>
</tr>
<tr class="field-odd field"><th class="field-name">t0:</th><td class="field-body">Initial time of the trajectory particle</td>
</tr>
<tr class="field-even field"><th class="field-name">subvol:</th><td class="field-body">The &#8220;volume&#8221; transport in m3/s of the trajectory</td>
</tr>
<tr class="field-odd field"><th class="field-name">temp:</th><td class="field-body">Temperature of the trajectory particle</td>
</tr>
<tr class="field-even field"><th class="field-name">salt:</th><td class="field-body">Salinity/specific humidity of the trajectory particle</td>
</tr>
<tr class="field-odd field"><th class="field-name">dens:</th><td class="field-body">Density of the trajectory particle</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-integrated-quantities">
<h3>The integrated quantities<a class="headerlink" href="#the-integrated-quantities" title="Permalink to this headline">¶</a></h3>
<p>In addition to the trajectories there are integrated quantities stored
in the code. These are activated by the preprocessing options in the
Makefile. The Lagrangian stream funtions are descibed by Equation
[eq:psixy] and [eq:psiyz]. They should be read in the same way as they
are written in writepsi.f95. The same goes for the simulated tracer
field written in writetracer.f95.</p>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-D<var>tracer</var></span></kbd></td>
<td>Turn on <a class="reference internal" href="diagnostics.html#barstream"><em>Lagrangian barotropic stream function</em></a>.</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-D<var>tra</var></span></kbd></td>
<td>You can set this variable to select a paper size.</td></tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="implementing-a-new-gcm-grid">
<h2>Implementing a new GCM grid<a class="headerlink" href="#implementing-a-new-gcm-grid" title="Permalink to this headline">¶</a></h2>
<p>You will need to penetrate the tracmass code in case you want to implement a new setup from a GCM with a grid that do not exist in the present TRACMASS. This requires good knowlidge in the numerical discretisation of your gcm and of Fortran programing. You do not get any support from the TRACMASS team for this. You will here just get some basic guidence how to do this.</p>
<p>1. Make a new &lt;project&gt;, which we call &#8220;mymodel&#8221; here.
Copy the directory from an existing project that has a similar grid (A,B or C-grid) or has a similar format (netcdf, grib, etc.). So that</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">cd </span>tracsvn/projects
cp -R orc mymodel
or
cp -R rco mymodel
or
cp -R ifs mymodel
</pre></div>
</div>
<p>You will now have to modify and adapt the files under tracsvn/projects/mymodel, which are readfield.f95, mymodel_grid.in and mymodel_run.in.</p>
<ol class="arabic simple" start="2">
<li>Modify tracsvn/coord.f95 if necssary unless you specify your new grid in tracsvn/mymodel/readfield.f95</li>
</ol>
<p>3. You will now have to add your project into the TRACMASS code itself with the many preprocessing options depending on the project you are running.
Search for a project with a similar vertical grid as yours (depth, sigma, atmospheric/ifs):</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">cd </span>tracsvn
grep rco *.f95
or
grep ifs *.f95
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li>Adapt the Makefile and set PROJECT = mymodel</li>
</ol>
</div>
</div>


</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2013, the TRACMASS Team.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2b1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>